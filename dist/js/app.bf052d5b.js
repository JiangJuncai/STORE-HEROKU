(function(e){function t(t){for(var o,n,l=t[0],i=t[1],c=t[2],p=0,d=[];p<l.length;p++)n=l[p],a[n]&&d.push(a[n][0]),a[n]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],o=!0,l=1;l<r.length;l++){var i=r[l];0!==a[i]&&(o=!1)}o&&(s.splice(t--,1),e=n(n.s=r[0]))}return e}var o={},a={app:0},s=[];function n(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=o,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=i;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"008c":function(e,t,r){},"089b":function(e,t,r){"use strict";var o=r("2c30"),a=r.n(o);a.a},"0a40":function(e,t,r){},"0e3c":function(e,t,r){"use strict";var o=r("0a40"),a=r.n(o);a.a},"1e3b":function(e,t,r){"use strict";var o=r("4c88"),a=r.n(o);a.a},2761:function(e,t,r){"use strict";var o=r("eb2a"),a=r.n(o);a.a},"2c30":function(e,t,r){},"463f":function(e,t,r){e.exports=r.p+"img/404.ccd8b4c0.gif"},"4c88":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var o=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},s=[],n=r("2877"),l={},i=Object(n["a"])(l,a,s,!1,null,null,null),c=i.exports,u=r("8c4f"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"index"},[r("el-container",{attrs:{direction:"vertical"}},[r("HeaderNav"),r("el-container",[r("Aside"),r("el-main",[r("router-view")],1)],1)],1)],1)},d=[],f=(r("ac6a"),r("456d"),r("7618")),m=r("04e1"),g=r.n(m),h=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-header",[o("el-row",{staticClass:"header",attrs:{type:"flex",justify:"space-between"}},[o("el-col",{staticClass:"title",attrs:{span:6}},[o("img",{attrs:{src:r("cf05"),alt:""}}),o("span",[e._v("店铺流水管理系统")])]),o("el-col",{attrs:{span:3.5}},[o("span",{staticClass:"identity"},[e._v(e._s(e.user.identity?"manager"==e.user.identity?"管理员:":"员工:":"请登录"))]),e.user.username?o("span",{staticClass:"user"},[e._v("\n        "+e._s(e.user.username?e.user.username:"请登录")+"\n        "),o("el-dropdown",{attrs:{trigger:"click"},on:{command:e.setDialogInfo}},[o("span",{staticClass:"el-dropdown-link"},[o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"info"}},[e._v("修改密码")]),o("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出")])],1)],1)],1):e._e()])],1),o("ChangePassword",{attrs:{dialog:e.dialog,user:e.user}})],1)},b=[],v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"修改密码",visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[r("el-form",{ref:"passwordForm",attrs:{model:e.password,rules:e.passwordRules}},[r("el-form-item",{attrs:{prop:"oldPassword",label:"输入旧密码","label-width":"130px"}},[r("el-input",{attrs:{type:"password","show-password":""},model:{value:e.password.oldPassword,callback:function(t){e.$set(e.password,"oldPassword",t)},expression:"password.oldPassword"}})],1),r("el-form-item",{attrs:{prop:"newPassword",label:"输入新密码","label-width":"130px"}},[r("el-input",{attrs:{type:"password","show-password":""},model:{value:e.password.newPassword,callback:function(t){e.$set(e.password,"newPassword",t)},expression:"password.newPassword"}})],1),r("el-form-item",{attrs:{prop:"newPassword2",label:"再次输入新密码","label-width":"130px"}},[r("el-input",{attrs:{type:"password","show-password":""},model:{value:e.password.newPassword2,callback:function(t){e.$set(e.password,"newPassword2",t)},expression:"password.newPassword2"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changePassword("passwordForm")}}},[e._v("确 定")])],1)],1)},w=[],y=(r("3022"),{name:"change-password",data:function(){var e=this,t=function(t,r,o){r!==e.password.newPassword?o(new Error("两次密码输入不一致")):o()};return{password:{oldPassword:"",newPassword:"",newPassword2:""},passwordRules:{oldPassword:[{required:!0,message:"请输入旧密码",triggle:"blur"},{pattern:/^[A-Za-z0-9]{4,12}$/,message:"6到12位（字母，数字）",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",triggle:"blur"},{pattern:/^[A-Za-z0-9]{4,12}$/,message:"6到12位（字母，数字）",trigger:"blur"}],newPassword2:[{required:!0,message:"请再次输入新密码",triggle:"blur"},{validator:t,trigger:"blur"}]}}},props:{dialog:Object,user:Object},methods:{changePassword:function(e){var t=this;this.$refs[e].validate(function(e){e?t.$axios.post("/users/password/".concat(t.user.id),t.password).then(function(e){t.$message({type:"success",message:e.data}),localStorage.removeItem("token"),t.$store.dispatch("clearCurrentState"),t.$router.push("/login")}):t.$message.error("表单填写错误")})}}}),x=y,_=Object(n["a"])(x,v,w,!1,null,null,null),k=_.exports,F={name:"headerNav",data:function(){return{dialog:{show:!1}}},computed:{user:function(){return this.$store.getters.user}},components:{ChangePassword:k},methods:{setDialogInfo:function(e){switch(e){case"info":this.changePassword();break;case"logout":this.logout();break}},changePassword:function(){this.dialog.show=!0},logout:function(){localStorage.removeItem("token"),this.$store.dispatch("clearCurrentState"),this.$router.push("/login")}}},$=F,C=(r("b066"),Object(n["a"])($,h,b,!1,null,"414083fa",null)),E=C.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-aside",{attrs:{width:"210px"}},[r("el-menu",{attrs:{"default-active":e.$route.path,router:"","text-color":"#304455","active-text-color":"#58c18c"}},[r("el-menu-item",{attrs:{index:"/index/home"}},[r("i",{staticClass:"el-icon-menu"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),r("el-submenu",{attrs:{index:"1"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-s-order"}),e._v("收支记录\n      ")]),r("el-menu-item",{attrs:{index:"/index/fundlist"}},[e._v("收支列表")])],2),r("el-submenu",{attrs:{index:"2"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-s-data"}),e._v("利润统计\n      ")]),r("el-menu-item",{attrs:{index:"/index/profitlist"}},[e._v("利润列表")])],2),r("el-submenu",{attrs:{index:"3"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-user-solid"}),e._v("用户管理\n      ")]),r("el-menu-item",{attrs:{index:"/index/userlist"}},[e._v("用户列表")])],2)],1)],1)},D=[],P=(r("a74e"),{}),q=Object(n["a"])(P,S,D,!1,null,"4941e88e",null),z=q.exports,j={name:"index",components:{HeaderNav:E,Aside:z},methods:{isEmpty:function(e){return void 0===e||null===e||"object"===Object(f["a"])(e)&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length}},created:function(){var e=localStorage.getItem("token"),t=g()(e);this.$store.dispatch("setAuthenticated",!this.isEmpty(t)),this.$store.dispatch("setUser",t)}},O=j,T=(r("2761"),Object(n["a"])(O,p,d,!1,null,null,null)),A=T.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home"},[r("el-row",{staticClass:"title-row"},[r("el-col",{attrs:{span:24}},[r("span",{staticClass:"home-title"},[e._v("店铺流水管理系统")])])],1),r("el-row",{staticClass:"progress-row"},[r("el-col",{staticClass:"progress-col",attrs:{span:8}},[r("div",{staticClass:"circle circle1"},[r("div",{staticClass:"circle-title"},[e._v(e._s(e.thisYear)+"年总营业额")]),r("div",{staticClass:"circle-data"},[e._v("\n          "+e._s(e.totalData.totalIncome)+"\n          "),r("span",[e._v("元")])])])]),r("el-col",{staticClass:"progress-col",attrs:{span:8}},[r("div",{staticClass:"circle circle2"},[r("div",{staticClass:"circle-title"},[e._v(e._s(e.thisYear)+"年总利润")]),r("div",{staticClass:"circle-data"},[e._v("\n          "+e._s(e.totalData.totalProfit)+"\n          "),r("span",[e._v("元")])])])]),r("el-col",{staticClass:"progress-col",attrs:{span:8}},[r("div",{staticClass:"circle circle3"},[r("div",{staticClass:"circle-title"},[e._v(e._s(e.thisYear)+"年售出烤鸭")]),r("div",{staticClass:"circle-data"},[e._v("\n          "+e._s(e.totalData.totalDuckCount)+"\n          "),r("span",[e._v("只")])])])])],1)],1)},Y=[],I={name:"home",data:function(){return{thisYear:"",totalData:{}}},methods:{},created:function(){var e=this;this.thisYear="".concat((new Date).getFullYear()),this.$axios.get("/income/".concat(this.thisYear)).then(function(t){e.totalData=t.data[0]})}},U=I,R=(r("1e3b"),Object(n["a"])(U,M,Y,!1,null,null,null)),L=R.exports,H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"title"},[e._v("用户注册")]),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toLogin}},[e._v("已有账号？登录")])],1),r("div",{staticClass:"text item"},[r("el-form",{ref:"registerForm",attrs:{model:e.registerForm,"status-icon":"",rules:e.registerRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{type:"text"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),r("el-form-item",{attrs:{label:"身份",prop:"identity"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.registerForm.identity,callback:function(t){e.$set(e.registerForm,"identity",t)},expression:"registerForm.identity"}},[r("el-option",{attrs:{label:"管理员",value:"manager",disabled:""}}),r("el-option",{attrs:{label:"员工",value:"employee"}})],1)],1),r("el-form-item",{attrs:{label:"注册码",prop:"key"}},[r("el-input",{attrs:{type:"text"},model:{value:e.registerForm.key,callback:function(t){e.$set(e.registerForm,"key",t)},expression:"registerForm.key"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"password2"}},[r("el-input",{attrs:{type:"password"},model:{value:e.registerForm.password2,callback:function(t){e.$set(e.registerForm,"password2",t)},expression:"registerForm.password2"}})],1),r("el-form-item",[r("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("registerForm")}}},[e._v("注册")])],1)],1)],1)])],1)},Z=[],N={name:"register",data:function(){var e=this,t=function(t,r,o){r!==e.registerForm.password?o(new Error("两次输入密码不一致!")):o()};return{registerForm:{username:"",password:"",password2:"",identity:"",key:""},registerRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[a-zA-Z0-9_-]{4,16}$/,message:"4到16位（字母，数字，下划线，减号）",trigger:"blur"}],key:[{required:!0,message:"请输入注册码",trigger:"blur"},{max:20,message:"注册码过长",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[A-Za-z0-9]{4,12}$/,message:"6到12位（字母，数字）",trigger:"blur"}],password2:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:t,trigger:"blur"}],identity:[{required:!0,message:"请选择身份",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({type:"error",message:"表单填写错误"}),!1;t.$axios.post("/users/register",t.registerForm).then(function(e){t.$message({type:"success",message:e.data}),t.$router.push("/login")})})},toLogin:function(){this.$router.push("/login")}}},B=N,Q=(r("5f38"),Object(n["a"])(B,H,Z,!1,null,null,null)),J=Q.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"title"},[e._v("用户登录")]),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toLogin}},[e._v("没有账号？注册")])],1),r("div",{staticClass:"text item"},[r("el-form",{ref:"loginForm",attrs:{model:e.loginForm,"status-icon":"",rules:e.loginRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{type:"text"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),r("el-form-item",[r("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("loginForm")}}},[e._v("登录")])],1)],1)],1)])],1)},K=[],V={name:"register",data:function(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[a-zA-Z0-9_-]{4,16}$/,message:"4到16位（字母，数字，下划线，减号）",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[A-Za-z0-9]{4,12}$/,message:"6到12位（字母，数字）",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({type:"error",message:"表单填写错误"}),!1;t.$axios.post("/users/login",t.loginForm).then(function(e){localStorage.setItem("token",e.data.token),t.$router.push("/index/home")})})},toLogin:function(){this.$router.push("/register")}}},W=V,X=(r("0e3c"),Object(n["a"])(W,G,K,!1,null,null,null)),ee=X.exports,te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"not-found"},[o("img",{attrs:{src:r("463f"),alt:""}}),o("el-button",{staticClass:"btn",attrs:{type:"success",icon:"el-icon-s-home"},on:{click:e.toHome}},[e._v("返回主页")])],1)},re=[],oe={name:"notFound",methods:{toHome:function(){this.$router.push("/index/home")}}},ae=oe,se=(r("b5c6"),Object(n["a"])(ae,te,re,!1,null,"67107b15",null)),ne=se.exports,le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"userlist"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,border:""}},[r("el-table-column",{attrs:{type:"index",width:"100",align:"center"}}),r("el-table-column",{attrs:{prop:"date",formatter:e.formatDate,label:"注册日期",align:"center"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),r("el-table-column",{attrs:{prop:"identity",label:"角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:"manager"==t.row.identity?"warning":"success",size:"medium"}},[e._v(e._s("manager"==t.row.identity?"管理员":"员工"))])]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small"},on:{click:function(r){return e.changeIdentity(t.$index,t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),r("el-dialog",{attrs:{title:"用户编辑",visible:e.showDialog,"before-close":e.beforeCloseDialog},on:{"update:visible":function(t){e.showDialog=t}}},[r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules}},[r("el-form-item",{attrs:{label:"用户名","label-width":"80px",prop:"username"}},[r("el-input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),r("el-form-item",{attrs:{label:"角色","label-width":"80px"}},[r("el-select",{attrs:{placeholder:"请选择角色权限"},model:{value:e.userForm.identity,callback:function(t){e.$set(e.userForm,"identity",t)},expression:"userForm.identity"}},[r("el-option",{attrs:{label:"管理员",value:"manager"}}),r("el-option",{attrs:{label:"员工",value:"employee"}})],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelDialog}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUser("userForm")}}},[e._v("确 定")])],1)],1)],1)},ie=[],ce=r("9285"),ue={name:"userlist",data:function(){return{users:[],showDialog:!1,userForm:{},userRules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{pattern:/^[a-zA-Z0-9_-]{4,16}$/,message:"4到16位（字母，数字，下划线，减号）",trigger:"blur"}]}}},methods:{formatDate:function(e,t,r,o){var a=ce["a"].format(new Date(r),"YYYY-MM-DD hh:mm:ss ZZ");return a},changeIdentity:function(e,t){this.showDialog=!0,this.userForm=t},handleDelete:function(e,t){var r=this;this.$confirm("是否删除用户".concat(t.username,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.$axios.delete("/users/".concat(t._id)).then(function(e){r.$message({type:"success",message:e.data}),r.fetchUserlist()})}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},fetchUserlist:function(){var e=this;this.$axios.get("/users").then(function(t){e.users=t.data})},editUser:function(){var e=this;this.$refs["userForm"].validate(function(t){if(!t)return e.$message.error("表单填写错误！"),!1;e.$axios.put("/users/".concat(e.userForm._id),e.userForm).then(function(t){e.$message({type:"success",message:t.data}),e.showDialog=!1})})},beforeCloseDialog:function(e){this.fetchUserlist(),e()},cancelDialog:function(){this.showDialog=!1,this.fetchUserlist()}},created:function(){this.fetchUserlist()}},pe=ue,de=Object(n["a"])(pe,le,ie,!1,null,null,null),fe=de.exports,me=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fundlist"},[r("el-row",{staticClass:"btn-area"},[r("el-col",{attrs:{span:20}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM",type:"month",placeholder:"选择要查询的月份"},model:{value:e.queryDate,callback:function(t){e.queryDate=t},expression:"queryDate"}}),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search",size:"medium"},on:{click:e.queryData}},[e._v("查询")])],1),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addProfile}},[e._v("添加数据")])],1)],1),r("ProfileDialog",{attrs:{dialog:e.dialog,profile:e.profile},on:{update:e.fetchProfles}}),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.profiles,border:"",size:"small"}},[r("el-table-column",{attrs:{prop:"date",formatter:e.formatDate,label:"日期",width:"120",align:"center"}}),r("el-table-column",{attrs:{prop:"isMarket",label:"集会日",width:"70",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("span",{style:"font-size:20px;color:"+(1==e.row.isMarket?"#67C23A":"#F56C6C")},[r("i",{class:"el-icon-circle-"+(1==e.row.isMarket?"check":"close")})])]}}])}),r("el-table-column",{attrs:{prop:"duckCount",label:"烤鸭数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#E6A23C"}},[e._v(e._s(t.row.duckCount))])]}}])}),r("el-table-column",{attrs:{prop:"income",label:"营业额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#409EFF"}},[e._v(e._s(t.row.income))])]}}])}),r("el-table-column",{attrs:{prop:"foodsExpend",label:"进货支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.foodsExpend))])]}}])}),r("el-table-column",{attrs:{prop:"frozenExpend",label:"冻鸭支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.frozenExpend))])]}}])}),r("el-table-column",{attrs:{prop:"otherExpend",label:"其它支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.otherExpend))])]}}])}),r("el-table-column",{attrs:{prop:"profit",label:"利润",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#67C23A"}},[e._v(e._s(t.row.profit))])]}}])}),r("el-table-column",{attrs:{prop:"remark",label:"备注",width:"180",align:"center"}}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small"},on:{click:function(r){return e.editProfile(t.$index,t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),r("el-row",{staticStyle:{"margin-top":"10px","text-align":"right"}},[r("el-col",{attrs:{span:24}},[r("el-pagination",{attrs:{"current-page":e.paginations.currentPage,"page-size":8,layout:"prev, pager, next, jumper",total:e.paginations.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.paginations,"currentPage",t)},"update:current-page":function(t){return e.$set(e.paginations,"currentPage",t)}}})],1)],1)],1)},ge=[],he=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)},open:e.beforeDialogOpen}},[r("el-form",{ref:"profileForm",attrs:{model:e.profileForm,rules:e.profileRules}},[r("el-tabs",{attrs:{"tab-position":"left"}},[r("el-tab-pane",{attrs:{label:"日常配置"}},[r("el-form-item",{attrs:{prop:"date",label:"日期","label-width":"80px"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.profileForm.date,callback:function(t){e.$set(e.profileForm,"date",t)},expression:"profileForm.date"}})],1),r("el-form-item",{attrs:{prop:"isMarket",label:"集会日","label-width":"80px"}},[r("el-radio-group",{model:{value:e.profileForm.isMarket,callback:function(t){e.$set(e.profileForm,"isMarket",t)},expression:"profileForm.isMarket"}},[r("el-radio",{attrs:{label:!1,border:"",size:"small"}},[e._v("否")]),r("el-radio",{attrs:{label:!0,border:"",size:"small"}},[e._v("是")])],1)],1),r("el-form-item",{attrs:{prop:"duckCount",label:"售出烤鸭","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入数量",clearable:""},model:{value:e.profileForm.duckCount,callback:function(t){e.$set(e.profileForm,"duckCount",e._n(t))},expression:"profileForm.duckCount"}},[r("template",{slot:"append"},[e._v("只")])],2)],1)],1),r("el-tab-pane",{attrs:{label:"流水金额"}},[r("el-form-item",{attrs:{prop:"income",label:"营业额","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:""},model:{value:e.profileForm.income,callback:function(t){e.$set(e.profileForm,"income",e._n(t))},expression:"profileForm.income"}})],1),r("el-form-item",{attrs:{prop:"foodsExpend",label:"进货支出","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:""},model:{value:e.profileForm.foodsExpend,callback:function(t){e.$set(e.profileForm,"foodsExpend",e._n(t))},expression:"profileForm.foodsExpend"}})],1),r("el-form-item",{attrs:{prop:"frozenExpend",label:"冻鸭支出","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:""},model:{value:e.profileForm.frozenExpend,callback:function(t){e.$set(e.profileForm,"frozenExpend",e._n(t))},expression:"profileForm.frozenExpend"}})],1),r("el-form-item",{attrs:{prop:"otherExpend",label:"其它支出","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:""},model:{value:e.profileForm.otherExpend,callback:function(t){e.$set(e.profileForm,"otherExpend",e._n(t))},expression:"profileForm.otherExpend"}})],1),r("el-form-item",{attrs:{prop:"profit",label:"日利润","label-width":"80px"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:""},model:{value:e.profit,callback:function(t){e.profit=e._n(t)},expression:"profit"}})],1)],1),r("el-tab-pane",{attrs:{label:"备注"}},[r("el-form-item",{attrs:{prop:"remark",label:"备注","label-width":"60px"}},[r("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容",clearable:""},model:{value:e.profileForm.remark,callback:function(t){e.$set(e.profileForm,"remark",e._n(t))},expression:"profileForm.remark"}})],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("profileForm")}}},[e._v("确 定")])],1)],1)},be=[],ve={name:"profile-dialog",data:function(){return{profileRules:{date:[{type:"string",required:!0,message:"请选择时间",triggle:"blur"}],isMarket:[{type:"boolean",required:!0,message:"请选择是否集会日",triggle:"blur"}],duckCount:[{type:"number",required:!0,message:"请输入卖出烤鸭的只数",triggle:"blur"}],income:[{type:"number",required:!0,message:"请输入营业额",triggle:"change"}],foodsExpend:[{type:"number",message:"请输入数字",triggle:"change"}],frozenExpend:[{type:"number",message:"请输入数字",triggle:"change"}],otherExpend:[{type:"number",message:"请输入数字",triggle:"change"}],profit:[{type:"number",required:!0,message:"日利润不能为空",triggle:"blur"}]}}},computed:{profileForm:{get:function(){return this.profile},set:function(e){}},profit:{get:function(){return this.profileForm.income-this.profileForm.foodsExpend-this.profileForm.frozenExpend-this.profileForm.otherExpend},set:function(e){}}},props:{dialog:Object,profile:Object},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e?(t.profileForm.profit=t.profit,"add"==t.dialog.option?t.$axios.post("/profiles/add",t.profileForm).then(function(e){t.$message.success(e.data),t.dialog.show=!1,t.$emit("update")}):t.$axios.put("/profiles/edit/".concat(t.profile._id),t.profileForm).then(function(e){t.$message.success(e.data),t.dialog.show=!1,t.$emit("update")})):t.$message.error("表单填写错误")})},beforeDialogOpen:function(){"add"==this.dialog.option&&this.$refs["profileForm"]&&this.$refs["profileForm"].resetFields()}}},we=ve,ye=Object(n["a"])(we,he,be,!1,null,null,null),xe=ye.exports,_e={name:"fundlist",data:function(){return{profiles:[],dialog:{show:!1,title:"",option:""},profile:{_id:"",date:"",isMarket:!1,duckCount:"",income:"",foodsExpend:"",frozenExpend:"",otherExpend:"",profit:0,remark:""},paginations:{currentPage:1,total:1},queryDate:"",isQuery:!1}},components:{ProfileDialog:xe},methods:{formatDate:function(e,t,r,o){var a=ce["a"].format(new Date(r),"YYYY-MM-DD");return a},addProfile:function(){this.dialog={show:!0,title:"添加数据",option:"add"},this.profile={date:"",isMarket:!1,duckCount:"",income:"",foodsExpend:"",frozenExpend:"",otherExpend:"",profit:0,remark:""}},editProfile:function(e,t){this.dialog={show:!0,title:"编辑数据",option:"edit"},this.profile={_id:t._id,date:t.date,isMarket:t.isMarket,duckCount:t.duckCount,income:t.income,foodsExpend:t.foodsExpend,frozenExpend:t.frozenExpend,otherExpend:t.otherExpend,profit:t.profit,remark:t.remark}},handleDelete:function(e,t){var r=this;this.$confirm("确认删除".concat(ce["a"].format(new Date(t.date),"YYYY-MM-DD"),"日的数据?"),"删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.$axios.delete("/profiles/".concat(t._id)).then(function(e){r.$message({type:"success",message:e.data}),r.fetchProfles()})}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},fetchProfles:function(){var e=this;this.$axios.post("/profiles",this.paginations).then(function(t){e.paginations.total=t.data.total,e.profiles=t.data.profiles})},handleCurrentChange:function(e){this.paginations.currentPage=e,this.isQuery?this.queryData():this.fetchProfles()},queryData:function(){var e=this;this.queryDate?(this.isQuery=!0,this.paginations.queryDate=this.queryDate,this.$axios.post("/profiles/query",this.paginations).then(function(t){e.paginations.total=t.data.total,e.profiles=t.data.profiles})):(this.isQuery=!1,this.fetchProfles())}},created:function(){this.fetchProfles()}},ke=_e,Fe=(r("089b"),Object(n["a"])(ke,me,ge,!1,null,"b9731844",null)),$e=Fe.exports,Ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"profitlist"},[r("el-row",{staticStyle:{"margin-bottom":"10px"}},[r("el-col",{attrs:{span:24}},[r("el-date-picker",{attrs:{"value-format":"yyyy",type:"year",placeholder:"选择要查询的年份"},model:{value:e.queryYear,callback:function(t){e.queryYear=t},expression:"queryYear"}}),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search",size:"medium"},on:{click:e.queryData}},[e._v("查询")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.profitList,border:""}},[r("el-table-column",{attrs:{prop:"_id",label:e.year+"年",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#304455"}},[e._v(e._s(t.row._id)+"月")])]}}])}),r("el-table-column",{attrs:{prop:"totalDuckCount",label:"烤鸭总数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#E6A23C"}},[e._v(e._s(t.row.totalDuckCount))])]}}])}),r("el-table-column",{attrs:{prop:"totalIncome",label:"营业额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#409EFF"}},[e._v(e._s(t.row.totalIncome))])]}}])}),r("el-table-column",{attrs:{prop:"totalFoods",label:"进货支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.totalFoods))])]}}])}),r("el-table-column",{attrs:{prop:"totalFrozen",label:"冻货支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.totalFrozen))])]}}])}),r("el-table-column",{attrs:{prop:"totalOther",label:"额外支出",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(t.row.totalOther))])]}}])}),r("el-table-column",{attrs:{prop:"totalProfit",label:"月利润",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#67C23A"}},[e._v(e._s(t.row.totalProfit))])]}}])})],1)],1)},Ee=[],Se={name:"profitlist",data:function(){return{profitList:[],year:"",queryYear:""}},methods:{getIncome:function(){var e=this,t=new Date;this.year="".concat(t.getFullYear()),this.$axios.get("/income",{params:{year:this.year}}).then(function(t){e.profitList=t.data})},queryData:function(){var e=this;this.queryYear?this.$axios.get("/income",{params:{year:this.queryYear}}).then(function(t){e.profitList=t.data}):this.getIncome()}},created:function(){this.getIncome()}},De=Se,Pe=Object(n["a"])(De,Ce,Ee,!1,null,null,null),qe=Pe.exports;o["default"].use(u["a"]);var ze=new u["a"]({mode:"history",base:"/",routes:[{path:"/",redirect:"/index"},{path:"/index",component:A,children:[{path:"",component:L},{path:"home",name:"home",component:L},{path:"userlist",name:"userlist",component:fe},{path:"fundlist",name:"fundlist",component:$e},{path:"profitlist",name:"profitlist",component:qe}]},{path:"/register",name:"register",component:J},{path:"/login",name:"login",component:ee},{path:"/*",name:"notFound",component:ne}]});ze.beforeEach(function(e,t,r){var o=!!localStorage.token;"/login"==e.path||"/register"==e.path?r():o?r():r("/login")});var je,Oe=ze,Te=r("bd86"),Ae=r("2f62");o["default"].use(Ae["a"]);var Me,Ye={isAuthenticated:!1,user:{}},Ie={isAuthenticated:function(e){return e.isAuthenticated},user:function(e){return Ye.user}},Ue={SET_AUTHENTICATED:"SET_AUTHENTICATED",SET_USER:"SET_USER"},Re=(je={},Object(Te["a"])(je,Ue.SET_AUTHENTICATED,function(e,t){e.isAuthenticated=t||!1}),Object(Te["a"])(je,Ue.SET_USER,function(e,t){e.user=t||{}}),je),Le={setAuthenticated:function(e,t){var r=e.commit;r(Ue.SET_AUTHENTICATED,t)},setUser:function(e,t){var r=e.commit;r(Ue.SET_USER,t)},clearCurrentState:function(e){var t=e.commit;t(Ue.SET_AUTHENTICATED,!1),t(Ue.SET_USER,null)}},He=new Ae["a"].Store({state:Ye,getters:Ie,mutations:Re,actions:Le}),Ze=r("5c96"),Ne=r.n(Ze),Be=(r("0fae"),r("bc3a")),Qe=r.n(Be);function Je(){Me=Ze["Loading"].service({lock:!0,text:"拼命加载中...",background:"rgba(0,0,0,0.7)"})}function Ge(){Me.close()}Qe.a.interceptors.request.use(function(e){return Je(),localStorage.token&&(e.headers.Authorization=localStorage.token),e},function(e){return Promise.reject(e)}),Qe.a.interceptors.response.use(function(e){return Ge(),e},function(e){Ge();var t=e.response.status;return 401==t?(Ze["Message"].error("token失效，请重新登录！"),localStorage.removeItem("token"),Oe.push("/login")):Ze["Message"].error(e.response.data),Promise.reject(e)});var Ke=Qe.a;o["default"].config.productionTip=!1,o["default"].use(Ne.a),o["default"].prototype.$axios=Ke,Ke.defaults.baseURL="https://storeheroku.herokuapp.com/api",new o["default"]({router:Oe,store:He,render:function(e){return e(c)}}).$mount("#app")},"5f38":function(e,t,r){"use strict";var o=r("86b0"),a=r.n(o);a.a},"86b0":function(e,t,r){},a74e:function(e,t,r){"use strict";var o=r("df94"),a=r.n(o);a.a},ae4b:function(e,t,r){},b066:function(e,t,r){"use strict";var o=r("ae4b"),a=r.n(o);a.a},b5c6:function(e,t,r){"use strict";var o=r("008c"),a=r.n(o);a.a},cf05:function(e,t,r){e.exports=r.p+"img/logo.82b9c7a5.png"},df94:function(e,t,r){},eb2a:function(e,t,r){}});
//# sourceMappingURL=app.bf052d5b.js.map